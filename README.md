# Claude Code OpenClaw Skill

## Overview

A skill for invoking Claude Code programmatically from OpenClaw for coding tasks, code analysis, and development automation.

## ⚠️ IMPORTANT: Project Directory Rule

**ALL projects developed with Claude Code MUST be created in your OpenClaw workspace directory.**

### How to Get Your Workspace Path

**Method 1: Using OpenClaw CLI (Recommended ⭐)**
```bash
openclaw config get agents.defaults.workspace
```

**Method 2: Quick Navigation Script**
```bash
# Add to ~/.zshrc or ~/.bashrc
alias cw='cd $(openclaw config get agents.defaults.workspace)'

# Then use:
cw  # Navigate to workspace
mkdir my-new-project
cd my-new-project
```

### Why This Rule Exists
- Centralized project management
- Easy to track and backup
- Consistent with OpenClaw's design
- Prevents scattered project locations

### How to Apply

**✅ CORRECT:**
```bash
cd $(openclaw config get agents.defaults.workspace)
mkdir project-name
cd project-name
# Develop project here
```

**❌ INCORRECT:**
```bash
cd ~/Projects
mkdir project-name  # Wrong location!
```

## Installation

Ensure Claude Code CLI is installed:
```bash
# macOS/Linux/WSL
curl -fsSL https://claude.ai/install.sh | bash

# Or use Homebrew
brew install --cask claude-code
```

## ⚠️ IMPORTANT: Correct Usage Format

### ✅ CORRECT Formats

```bash
# Basic query (recommended)
claude -p "Your task here"

# With PTY for interactive features
claude -p "Your task" --pty

# Specify model
claude --model minimax/MiniMax-M2.1 -p "Your task"

# Interactive session
claude
```

### ❌ INCORRECT Formats

```bash
# WRONG - bash pty:true is NOT valid syntax
bash pty:true command:"claude -p 'Task'"

# WRONG - This syntax doesn't work
claude pty:true -p "Task"
```

## Quick Start

```bash
# Simple query
claude -p "What does this project do?"

# Create a file (manual verification recommended)
claude -p "Create index.html with basic structure"

# Analyze code
claude -p "Analyze this codebase structure"
```

## Configuration

### Set Default Model (MiniMax-M2.1)
```bash
openclaw config set env.ANTHROPIC_MODEL "MiniMax-M2.1"
openclaw gateway restart
```

### Add to Allowlist (Required for File Operations)
```bash
openclaw approvals allowlist add "/Users/apple/.local/bin/claude"
```

This allows Claude Code to create and edit files through OpenClaw.

## Best Practices

1. **Use Short, Focused Tasks**
   - ✅ Good: `claude -p "What does this function do?"`
   - ❌ Avoid: `claude -p "Build entire application"`

2. **Break Complex Tasks**
   ```bash
   claude -p "Step 1: Create HTML structure"
   claude -p "Step 2: Add CSS styling"
   claude -p "Step 3: Implement JavaScript logic"
   ```

3. **Verify Output**
   - Always manually check code generated by Claude Code
   - Test in browser before committing

4. **Use Read-Only Queries When Possible**
   ```bash
   # Read-only (faster, fewer permissions needed)
   claude -p "Analyze this code"
   
   # File creation (slower, needs allowlist)
   claude -p "Create new file"
   ```

## Troubleshooting

### Claude Code Not Responding
1. Check configuration: `cat ~/.claude/settings.json`
2. Set environment variable: `openclaw config set env.ANTHROPIC_MODEL "MiniMax-M2.1"`
3. Restart gateway: `openclaw gateway restart`

### Permission Denied for File Operations
```bash
# Add Claude Code to allowlist
openclaw approvals allowlist add "/path/to/claude"
```

### Sessions Getting SIGKILL
- Use shorter tasks
- Break complex work into steps
- Use manual implementation for reliability

## Project Structure Template

```
~/.openclaw/workspace/
└── project-name/
    ├── index.html          # Main HTML
    ├── styles.css          # All styles
    ├── script.js           # Application logic
    └── .specify/           # Spec-Kit workflow (if used)
        ├── memory/
        │   └── constitution.md
        └── specs/
            └── 001-feature-name/
                ├── spec.md
                ├── plan.md
                └── tasks.md
```

## Documentation

- **Full Documentation**: [SKILL.md](./SKILL.md)
- **Examples**: [examples/QUICK_REFERENCE.md](./examples/QUICK_REFERENCE.md)
- **Usage Scripts**: [examples/USAGE.sh](./examples/USAGE.sh)

## Related Resources

- [Claude Code Official Docs](https://code.claude.com/docs)
- [OpenClaw Documentation](https://docs.openclaw.ai)
- [Spec-Kit](https://github.com/github/spec-kit) - For structured development workflow

## Notes

- This skill provides a wrapper for Claude Code CLI
- For best results, use in combination with spec-kit for planning
- Manual verification of generated code is recommended
- Always create projects in `~/.openclaw/workspace/`
